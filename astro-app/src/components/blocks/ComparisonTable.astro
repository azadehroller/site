---
/**
 * Comparison Table Component
 * Based on HubSpot module: comparison-table.module
 * 
 * A side-by-side comparison table showing features/benefits
 * with checkmarks for positive items and X marks for competitor/negative items
 */
import { cleanStega } from '../../utils/stega';
import type { ComparisonColumn, ComparisonItem } from '../../utils/sanity';

interface Props {
  columns?: ComparisonColumn[];
  id?: string;
}

const { columns, id } = Astro.props;

// Generate a unique ID for the table
const tableId = cleanStega(id) || `comparison-table-${Math.random().toString(36).slice(2, 11)}`;
---

<section id={tableId} class="my-4">
    <div class="md:flex w-full table-auto box-shadow-onlight-blue-40">
        {columns?.map((column, colIndex) => {
            const isCompetitor = column.isCompetitor;
            const columnTitle = column.title;
            const items = column.items || [];
            const columnWidth = columns.length === 2 ? 'md:w-1/2' : `md:w-1/${columns.length}`;
            
            return (
                <div class={`comparison w-full ${columnWidth}`}>
                    <div class={`py-3 px-2 text-center ${isCompetitor ? 'bg-primary-70' : 'bg-primary-40'}`}>
                        <h3 class="text-2xl text-neutral-white">{columnTitle}</h3>
                    </div>
                    <ul class="m-0">
                        {items.map((item, itemIndex) => {
                            const bgClass = itemIndex % 2 === 0 ? 'bg-[#F5F8FF]' : 'bg-neutral-white';
                            return (
                                <li class={`${bgClass} flex flex-row gap-2 py-3 px-4 text-base text-primary-50`}>
                                    <span>
                                        {isCompetitor ? (
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="#E50B0B"/>
                                            </svg>
                                        ) : (
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path d="M9.00039 16.2L4.80039 12L3.40039 13.4L9.00039 19L21.0004 6.99998L19.6004 5.59998L9.00039 16.2Z" fill="#18F273"/>
                                            </svg>
                                        )}
                                    </span>
                                    <span>{item.text}</span>
                                </li>
                            );
                        })}
                    </ul>
                </div>
            );
        })}
    </div>
</section>


